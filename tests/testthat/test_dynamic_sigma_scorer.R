library(otsad)
context("Dynamic Sigma Scorer")

test_that("DynamicSigmaScorer gives the correct result", {

  a <- c(0.590, 0.157, 0.052, 1.027, 0.274, 0.357, 1.464, 1.797, 0.546, 0.749, 0.028, 1.449,
         0.008, 2.520, 0.780, 1.180, 0.985, 1.919, 1.678, 1.046, 0.517, 0.375, 0.832, 0.376,
         0.709, 0.046, 0.771, 0.286, 0.343, 0.378, 1.321, 1.404, 1.054, 0.662, 0.357, 0.283,
         0.586, 2.577, 0.262, 0.208, 0.115, 1.387, 0.016, 1.649, 0.613, 0.362, 0.439, 0.202,
         2.671, 0.334, 0.653, 0.248, 0.149, 0.808, 0.216, 0.319, 0.042, 3.356, 0.151, 1.901,
         0.625, 0.592, 0.777, 1.742, 2.011, 0.957, 1.002, 1.311, 0.255, 1.043, 0.369, 1.177,
         1.023, 0.118, 0.861, 1.176, 2.120, 1.332, 0.720, 0.052, 0.636, 1.173, 0.278, 0.037,
         1.753, 0.493, 0.124, 0.064, 1.242, 0.196, 0.297, 0.471, 1.234, 1.544, 1.918, 0.716,
         0.665, 1.496, 0.491, 0.816)

  res <- c(0.000, 0.038, 0.042, 0.118, 0.010, 0.002, 0.213, 0.195, 0.005, 0.001, 0.082, 0.111,
           0.084, 0.325, 0.000, 0.020, 0.004, 0.145, 0.079, 0.002, 0.024, 0.041, 0.000, 0.040,
           0.004, 0.102, 0.001, 0.049, 0.037, 0.030, 0.053, 0.066, 0.011, 0.005, 0.040, 0.052,
           0.008, 0.421, 0.053, 0.061, 0.077, 0.061, 0.099, 0.120, 0.006, 0.032, 0.021, 0.057,
           0.429, 0.034, 0.003, 0.046, 0.063, 0.000, 0.050, 0.032, 0.081, 0.601, 0.053, 0.154,
           0.004, 0.005, 0.000, 0.118, 0.178, 0.003, 0.004, 0.032, 0.046, 0.007, 0.030, 0.018,
           0.006, 0.072, 0.000, 0.019, 0.218, 0.035, 0.002, 0.090, 0.006, 0.017, 0.047, 0.092,
           0.123, 0.017, 0.073, 0.083, 0.028, 0.058, 0.040, 0.017, 0.029, 0.082, 0.172, 0.002,
           0.004, 0.069, 0.018, 0.000)

  scorer <- DynamicSigmaScorer$new()

  scores <- round(sapply(a, function(x) {scorer$computeScore(x)}), 3)

  expect_equal(scores, res)

})
